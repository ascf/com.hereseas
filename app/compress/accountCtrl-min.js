hereseasApp.controller("AccountCtrl",["$scope","$state","$window","requestService","userService","$mdDialog","$cookies","alertService",function(e,r,o,i,t,n,s,a){e.state=t.getSignupOrLogin(),e.login_err=!1,e.nonedu_err=!1,e.exist_err=!1,e.emailerr=!1,e.psworderr=!1,e.usererr=!1,e.need_activate=!1,e.signUpData={},e.userData={},e.createForgetter=function(){i.CreateForgetter(e.userData,function(r){r.result?e.state="resetTrue":e.state="resetFalse"})},e.user={email:"",password:"",remember:!0},e.emailpattern=/^.+@.+\..+$/,e.socialLogins=[{icon:"fa-twitter",color:"#5bc0de",url:"#"},{icon:"fa-facebook",color:"#337ab7",url:"#"},{icon:"fa-google-plus",color:"#e05d6f",url:"#"},{icon:"fa-linkedin",color:"#337ab7",url:"#"}],e.hide=function(){n.hide()},e.goSignup=function(){e.state="signup",t.setSignupOrLogin("signup"),e.login_err=!1,e.emailerr=!1,e.psworderr=!1},e.goReset=function(){e.state="reset",e.emailerr=!1,e.login_err=!1,e.psworderr=!1,e.usererr=!1,e.nonedu_err=!1,e.exist_err=!1},e.goLogin=function(){e.state="login",t.setSignupOrLogin("login"),e.emailerr=!1,e.psworderr=!1,e.usererr=!1,e.nonedu_err=!1,e.exist_err=!1},e.rememberMe=function(){},e.loginClick=function(){var o=e.emailpattern.test(e.user.email);o?e.emailerr=!1:e.emailerr=!0,e.user.password.length<6?e.psworderr=!0:e.psworderr=!1,e.psworderr||e.emailerr||i.DoLogin(e.user,function(o){o.result?i.GetUserSelf(function(o){s.userId=o.data.id,s.login=!0,e.hide(),e.login_err=!1,void 0!==o.data.schoolId?(s.schoolId=o.data.schoolId,r.go("school",{schoolId:o.data.schoolId})):r.reload()}):"ERR_ACTIVATED_ERR"==o.err?e.need_activate=!0:e.login_err=!0})},e.signUpSubmit=function(){var r=e.emailpattern.test(e.signUpData.email);r?e.emailerr=!1:e.emailerr=!0,void 0==e.signUpData.password?e.psworderr=!0:e.psworderr=!1,void 0==e.signUpData.username?e.usererr=!0:e.usererr=!1,e.psworderr||e.emailerr||e.usererr||i.DoRegister(e.signUpData,function(r){r.result?(a.alert("注册成功，请登录您的邮箱进行验证！"),e.hide()):"ERR_NOT_EDUEMAIL_ERR"==r.err?(e.exist_err=!1,e.nonedu_err=!0):"ERR_EXISTED_EMAIL "==r.err&&(e.nonedu_err=!1,e.exist_err=!0)})},e.forgetpw=function(){e.hide()}}]);